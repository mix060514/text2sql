id,question,expected,type,planned_agent_v4_actual,planned_agent_v4_sql_query,planned_agent_v4_sql_result,planned_agent_v4_correct,problematic
12,India 訂單數量最多的客戶是誰？,Delta Global Systems,string,"{
  ""sql"": ""SELECT \""Customer Name\"", COUNT(\""Order ID\"") as order_count FROM sales_data WHERE Country = 'India' GROUP BY \""Customer Name\"" ORDER BY order_count DESC LIMIT 1;"",
  ""results"": [
    [
      ""Summit Beta Solutions"",
      20
    ]
  ]
}","SELECT ""Customer Name"", COUNT(""Order ID"") as order_count FROM sales_data WHERE Country = 'India' GROUP BY ""Customer Name"" ORDER BY order_count DESC LIMIT 1;","[('Summit Beta Solutions', 20)]",False,True
13,Germany 訂單數量最多的客戶是誰？,Summit Beta Solutions,string,"```sql
SELECT ""Customer Name"", COUNT(""Order ID"") as order_count FROM sales_data WHERE Country = 'Germany' GROUP BY ""Customer Name"" ORDER BY order_count DESC LIMIT 1;
```
[('Summit Prime Systems', 32)]","SELECT ""Customer Name"", COUNT(""Order ID"") as order_count FROM sales_data WHERE Country = 'Germany' GROUP BY ""Customer Name"" ORDER BY order_count DESC LIMIT 1;","[('Summit Prime Systems', 32)]",False,True
16,2023 年哪一個季度的總銷售額表現最好？,Q4,string,"```sql
SELECT strftime('%Y', ""Order Date"") as year, strftime('%m', ""Order Date"") as month, SUM(""Total Revenue"") as total_revenue 
FROM sales_data 
WHERE strftime('%Y', ""Order Date"") = '2023' 
GROUP BY strftime('%Y', ""Order Date""), strftime('%m', ""Order Date"") 
ORDER BY total_revenue DESC 
LIMIT 1;
```
[[2023, '12', 5718310.93]]","SELECT strftime('%Y', ""Order Date"") as year, strftime('%m', ""Order Date"") as month, SUM(""Total Revenue"") as total_revenue FROM sales_data WHERE strftime('%Y', ""Order Date"") = '2023' GROUP BY strftime('%Y', ""Order Date""), strftime('%m', ""Order Date"") ORDER BY total_revenue DESC LIMIT 1;","[('2023', '12', 5718310.93)]",False,True
17,2024 年哪一個季度的總銷售額表現最好？,Q4,string,"```sql
SELECT SUM(""Total Revenue"") as total_revenue, strftime('%Y-%m', ""Order Date"") as order_month 
FROM sales_data 
WHERE strftime('%Y', ""Order Date"") = '2024' 
GROUP BY order_month 
ORDER BY total_revenue DESC 
LIMIT 1;
```
[(5968798.39, '2024-10')]","SELECT SUM(""Total Revenue"") as total_revenue, strftime('%Y-%m', ""Order Date"") as order_month FROM sales_data WHERE strftime('%Y', ""Order Date"") = '2024' GROUP BY order_month ORDER BY total_revenue DESC LIMIT 1;","[(5968798.39, '2024-10')]",False,True
18,Electronics 類別在 2024 年相對於 2023 年的銷售額年增率 (YoY) 是多少？,-3.06,number,"{
  ""sql_query"": ""SELECT (SUM(CASE WHEN strftime('%Y', \""Order Date\"") = '2024' THEN \""Total Revenue\"" ELSE 0 END) - SUM(CASE WHEN strftime('%Y', \""Order Date\"") = '2023' THEN \""Total Revenue\"" ELSE 0 END)) / NULLIF(SUM(CASE WHEN strftime('%Y', \""Order Date\"") = '2023' THEN \""Total Revenue\"" ELSE 0 END), 0) AS yoy_growth FROM sales_data WHERE \""Product Category\"" = 'Electronics';"",
  ""results"": [
    [
      -0.030645325530624802
    ]
  ]
}","SELECT (SUM(CASE WHEN strftime('%Y', ""Order Date"") = '2024' THEN ""Total Revenue"" ELSE 0 END) - SUM(CASE WHEN strftime('%Y', ""Order Date"") = '2023' THEN ""Total Revenue"" ELSE 0 END)) / NULLIF(SUM(CASE WHEN strftime('%Y', ""Order Date"") = '2023' THEN ""Total Revenue"" ELSE 0 END), 0) AS yoy_growth FROM sales_data WHERE ""Product Category"" = 'Electronics';","[(-0.030645325530624802,)]",False,True
21,請列出 North America 區域在 2023 至 2024 年每個月的銷售趨勢數據。,"{'2023-1': 1501225.0, '2023-2': 1298301.23, '2023-3': 1560968.94, '2023-4': 1569450.64, '2023-5': 1239067.23, '2023-6': 1486196.84, '2023-7': 1447348.91, '2023-8': 1640436.4, '2023-9': 1673169.96, '2023-10': 2373057.31, '2023-11': 2117893.69, '2023-12': 2379353.47, '2024-1': 1516790.82, '2024-2': 1431760.02, '2024-3': 1736514.22, '2024-4': 1387412.77, '2024-5': 1535990.27, '2024-6': 1539895.94, '2024-7': 1464171.52, '2024-8': 1338957.31, '2024-9': 1074612.67, '2024-10': 2294689.2, '2024-11': 2018162.44, '2024-12': 2306937.48}",dataframe,"```sql
SELECT strftime('%Y-%m', ""Order Date"") as month, SUM(""Total Revenue"") as total_revenue 
FROM sales_data 
WHERE Region = 'North America' 
  AND strftime('%Y', ""Order Date"") BETWEEN '2023' AND '2024' 
GROUP BY month 
ORDER BY month;
```

[('2023-01', 1501225.0), ('2023-02', 1298301.23), ('2023-03', 1560968.94), ('2023-04', 1569450.64), ('2023-05', 1239067.23), ('2023-06', 1486196.84), ('2023-07', 1447348.91), ('2023-08', 1640436.4), ('2023-09', 1673169.96), ('2023-10', 2373057.31), ('2023-11', 2117893.69), ('2023-12', 2379353.47), ('2024-01', 1516790.82), ('2024-02', 1431760.02), ('2024-03', 1736514.22), ('2024-04', 1387412.77), ('2024-05', 1535990.27), ('2024-06', 1539895.94), ('2024-07', 1464171.52), ('2024-08', 1338957.31), ('2024-09', 1074612.67), ('2024-10', 2294689.2), ('2024-11', 2018162.44), ('2024-12', 2306937.48)]
","SELECT strftime('%Y-%m', ""Order Date"") as month, SUM(""Total Revenue"") as total_revenue FROM sales_data WHERE Region = 'North America' AND strftime('%Y', ""Order Date"") BETWEEN '2023' AND '2024' GROUP BY month ORDER BY month;","[('2023-01', 1501225.0), ('2023-02', 1298301.23), ('2023-03', 1560968.94), ('2023-04', 1569450.64), ('2023-05', 1239067.23), ('2023-06', 1486196.84), ('2023-07', 1447348.91), ('2023-08', 1640436.4), ('2023-09', 1673169.96), ('2023-10', 2373057.31), ('2023-11', 2117893.69), ('2023-12', 2379353.47), ('2024-01', 1516790.82), ('2024-02', 1431760.02), ('2024-03', 1736514.22), ('2024-04', 1387412.77), ('2024-05', 1535990.27), ('2024-06', 1539895.94), ('2024-07', 1464171.52), ('2024-08', 1338957.31), ('2024-09', 1074612.67), ('2024-10', 2294689.2), ('2024-11', 2018162.44), ('2024-12', 2306937.48)]",False,True
22,請列出 LATAM 區域在 2023 至 2024 年每個月的銷售趨勢數據。,"{'2023-1': 223713.48, '2023-2': 175948.62, '2023-3': 214276.38, '2023-4': 153375.98, '2023-5': 324390.47, '2023-6': 200221.42, '2023-7': 116414.84, '2023-8': 175005.51, '2023-9': 267708.42, '2023-10': 349280.05, '2023-11': 304090.41, '2023-12': 347328.27, '2024-1': 145904.33, '2024-2': 153470.14, '2024-3': 417749.45, '2024-4': 171977.2, '2024-5': 173912.15, '2024-6': 207575.73, '2024-7': 203863.23, '2024-8': 159882.9, '2024-9': 143958.6, '2024-10': 270168.5, '2024-11': 315395.29, '2024-12': 180159.21}",dataframe,"```sql
SELECT strftime('%Y-%m', ""Order Date"") as month, SUM(""Total Revenue"") as total_revenue 
FROM sales_data 
WHERE Region = 'LATAM' 
  AND strftime('%Y', ""Order Date"") IN ('2023', '2024') 
GROUP BY month 
ORDER BY month;
```

Results:
[('2023-01', 223713.48), ('2023-02', 175948.62), ('2023-03', 214276.38), ('2023-04', 153375.98), ('2023-05', 324390.47000000003), ('2023-06', 200221.42), ('2023-07', 116414.84), ('2023-08', 175005.51), ('2023-09', 267708.42), ('2023-10', 349280.05), ('2023-11', 304090.41), ('2023-12', 347328.27), ('2024-01', 145904.33), ('2024-02', 153470.13999999998), ('2024-03', 417749.45), ('2024-04', 171977.2), ('2024-05', 173912.15), ('2024-06', 207575.73), ('2024-07', 203863.23), ('2024-08', 159882.9), ('2024-09', 143958.6), ('2024-10', 270168.5), ('2024-11', 315395.29), ('2024-12', 180159.21)]
","SELECT strftime('%Y-%m', ""Order Date"") as month, SUM(""Total Revenue"") as total_revenue FROM sales_data WHERE Region = 'LATAM' AND strftime('%Y', ""Order Date"") IN ('2023', '2024') GROUP BY month ORDER BY month;","[('2023-01', 223713.48), ('2023-02', 175948.62), ('2023-03', 214276.38), ('2023-04', 153375.98), ('2023-05', 324390.47000000003), ('2023-06', 200221.42), ('2023-07', 116414.84), ('2023-08', 175005.51), ('2023-09', 267708.42), ('2023-10', 349280.05), ('2023-11', 304090.41), ('2023-12', 347328.27), ('2024-01', 145904.33), ('2024-02', 153470.13999999998), ('2024-03', 417749.45), ('2024-04', 171977.2), ('2024-05', 173912.15), ('2024-06', 207575.73), ('2024-07', 203863.23), ('2024-08', 159882.9), ('2024-09', 143958.6), ('2024-10', 270168.5), ('2024-11', 315395.29), ('2024-12', 180159.21)]",False,True
23,請列出 EMEA 區域在 2023 至 2024 年每個月的銷售趨勢數據。,"{'2023-1': 942448.1, '2023-2': 883639.02, '2023-3': 1285595.76, '2023-4': 883185.84, '2023-5': 1185861.27, '2023-6': 1484438.38, '2023-7': 1016786.45, '2023-8': 1020389.97, '2023-9': 1059744.44, '2023-10': 1654875.41, '2023-11': 1624625.45, '2023-12': 1634231.28, '2024-1': 1133643.54, '2024-2': 1062111.55, '2024-3': 1012640.24, '2024-4': 992568.9, '2024-5': 1040289.1, '2024-6': 880005.25, '2024-7': 1208996.95, '2024-8': 1059911.19, '2024-9': 1059862.75, '2024-10': 1679514.33, '2024-11': 1766008.98, '2024-12': 1283154.02}",dataframe,"```sql
SELECT strftime('%Y-%m', ""Order Date"") as month, SUM(""Total Revenue"") as total_revenue 
FROM sales_data 
WHERE Region = 'EMEA' 
  AND strftime('%Y', ""Order Date"") BETWEEN '2023' AND '2024' 
GROUP BY month 
ORDER BY month;
```

Results:
[('2023-01', 942448.1), ('2023-02', 883639.02), ('2023-03', 1285595.76), ('2023-04', 883185.84), ('2023-05', 1185861.27), ('2023-06', 1484438.38), ('2023-07', 1016786.45), ('2023-08', 1020389.97), ('2023-09', 1059744.44), ('2023-10', 1654875.41), ('2023-11', 1624625.45), ('2023-12', 1634231.28), ('2024-01', 1133643.54), ('2024-02', 1062111.55), ('2024-03', 1012640.24), ('2024-04', 992568.9), ('2024-05', 1040289.1), ('2024-06', 880005.25), ('2024-07', 1208996.95), ('2024-08', 1059911.19), ('2024-09', 1059862.75), ('2024-10', 1679514.33), ('2024-11', 1766008.98), ('2024-12', 1283154.02)]
","SELECT strftime('%Y-%m', ""Order Date"") as month, SUM(""Total Revenue"") as total_revenue FROM sales_data WHERE Region = 'EMEA' AND strftime('%Y', ""Order Date"") BETWEEN '2023' AND '2024' GROUP BY month ORDER BY month;","[('2023-01', 942448.1), ('2023-02', 883639.02), ('2023-03', 1285595.76), ('2023-04', 883185.84), ('2023-05', 1185861.27), ('2023-06', 1484438.38), ('2023-07', 1016786.45), ('2023-08', 1020389.97), ('2023-09', 1059744.44), ('2023-10', 1654875.41), ('2023-11', 1624625.45), ('2023-12', 1634231.28), ('2024-01', 1133643.54), ('2024-02', 1062111.55), ('2024-03', 1012640.24), ('2024-04', 992568.9), ('2024-05', 1040289.1), ('2024-06', 880005.25), ('2024-07', 1208996.95), ('2024-08', 1059911.19), ('2024-09', 1059862.75), ('2024-10', 1679514.33), ('2024-11', 1766008.98), ('2024-12', 1283154.02)]",False,True
24,請列出 APAC 區域在 2023 至 2024 年每個月的銷售趨勢數據。,"{'2023-1': 973776.02, '2023-2': 763996.82, '2023-3': 1005437.21, '2023-4': 1085883.84, '2023-5': 999851.05, '2023-6': 825946.06, '2023-7': 897312.68, '2023-8': 805145.36, '2023-9': 984447.16, '2023-10': 1189276.6, '2023-11': 1336621.74, '2023-12': 1357397.91, '2024-1': 933316.4, '2024-2': 1075906.73, '2024-3': 971237.02, '2024-4': 1076606.9, '2024-5': 1015613.24, '2024-6': 827017.19, '2024-7': 1053949.91, '2024-8': 888200.25, '2024-9': 757630.84, '2024-10': 1724426.36, '2024-11': 1436229.04, '2024-12': 1301473.82}",dataframe,"```sql
SELECT strftime('%Y-%m', ""Order Date"") as month, SUM(""Total Revenue"") as total_revenue 
FROM sales_data 
WHERE Region = 'APAC' 
  AND strftime('%Y', ""Order Date"") BETWEEN '2023' AND '2024' 
GROUP BY month 
ORDER BY month;
```

Results:
[('2023-01', 973776.02), ('2023-02', 763996.82), ('2023-03', 1005437.21), ('2023-04', 1085883.84), ('2023-05', 999851.05), ('2023-06', 825946.06), ('2023-07', 897312.68), ('2023-08', 805145.36), ('2023-09', 984447.16), ('2023-10', 1189276.6), ('2023-11', 1336621.74), ('2023-12', 1357397.91), ('2024-01', 933316.4), ('2024-02', 1075906.73), ('2024-03', 971237.02), ('2024-04', 1076606.9), ('2024-05', 1015613.24), ('2024-06', 827017.19), ('2024-07', 1053949.91), ('2024-08', 888200.25), ('2024-09', 757630.84), ('2024-10', 1724426.36), ('2024-11', 1436229.04), ('2024-12', 1301473.82)]","SELECT strftime('%Y-%m', ""Order Date"") as month, SUM(""Total Revenue"") as total_revenue FROM sales_data WHERE Region = 'APAC' AND strftime('%Y', ""Order Date"") BETWEEN '2023' AND '2024' GROUP BY month ORDER BY month;","[('2023-01', 973776.02), ('2023-02', 763996.82), ('2023-03', 1005437.21), ('2023-04', 1085883.84), ('2023-05', 999851.05), ('2023-06', 825946.06), ('2023-07', 897312.68), ('2023-08', 805145.36), ('2023-09', 984447.16), ('2023-10', 1189276.6), ('2023-11', 1336621.74), ('2023-12', 1357397.91), ('2024-01', 933316.4), ('2024-02', 1075906.73), ('2024-03', 971237.02), ('2024-04', 1076606.9), ('2024-05', 1015613.24), ('2024-06', 827017.19), ('2024-07', 1053949.91), ('2024-08', 888200.25), ('2024-09', 757630.84), ('2024-10', 1724426.36), ('2024-11', 1436229.04), ('2024-12', 1301473.82)]",False,True
25,2024 年第四季相較於 2023 年第四季，總銷售額增加了多少？,-91712.92,number,"SQL used:
```sql
SELECT 
    SUM(CASE WHEN strftime('%m', ""Order Date"") = '12' THEN ""Total Revenue"" ELSE 0 END) AS Q4_2024_Revenue,
    SUM(CASE WHEN strftime('%m', ""Order Date"") = '12' AND strftime('%Y', ""Order Date"") = '2023' THEN ""Total Revenue"" ELSE 0 END) AS Q4_2023_Revenue
FROM sales_data;
```

Results:
- Q4 2024 Total Revenue: 10,790,035.46
- Q4 2023 Total Revenue: 5,718,310.93

The increase in total revenue from Q4 2023 to Q4 2024 is:
10,790,035.46 - 5,718,310.93 = **5,071,724.53**

Therefore, the total revenue increased by **5,071,724.53**.","SELECT SUM(CASE WHEN strftime('%m', ""Order Date"") = '12' THEN ""Total Revenue"" ELSE 0 END) AS Q4_2024_Revenue, SUM(CASE WHEN strftime('%m', ""Order Date"") = '12' AND strftime('%Y', ""Order Date"") = '2023' THEN ""Total Revenue"" ELSE 0 END) AS Q4_2023_Revenue FROM sales_data;","[(10790035.46, 5718310.93)]",False,True
26,在 North America 區域，2023 年前五大客戶購買各產品類別的金額占比為何？,"{'Delta Elite Systems': {'Electronics': 0.225, 'Office Supplies': 0.096, 'Software': 0.679}, 'Global Beta Corp.': {'Electronics': 0.3834, 'Office Supplies': 0.0513, 'Software': 0.5654}, 'Next Beta Ltd.': {'Electronics': 0.5828, 'Office Supplies': 0.1038, 'Software': 0.3134}, 'Prime Delta Solutions': {'Electronics': 0.6316, 'Office Supplies': 0.1253, 'Software': 0.243}, 'Summit Prime Systems': {'Electronics': 0.5044, 'Office Supplies': 0.1148, 'Software': 0.3809}}",dataframe,"```sql
SELECT 
    ""Customer Name"", 
    ""Product Category"", 
    SUM(""Total Revenue"") as revenue, 
    SUM(""Total Revenue"") * 100.0 / SUM(""Total Revenue"") OVER (PARTITION BY ""Customer Name"") as revenue_percentage 
FROM sales_data 
WHERE Region = 'North America' 
    AND strftime('%Y', ""Order Date"") = '2023' 
GROUP BY ""Customer Name"", ""Product Category"" 
ORDER BY revenue DESC 
LIMIT 5;
```

[
  (
    'Delta Elite Systems',
    'Software',
    264491.81,
    3285.1962856880245
  ),
  (
    'Global Prime Inc.',
    'Electronics',
    172665.87,
    3393.1100551808704
  ),
  (
    'Global Beta Corp.',
    'Software',
    169027.36,
    1658.911871077284
  ),
  (
    'Prime Delta Solutions',
    'Electronics',
    166806.54,
    1816.318788471401
  ),
  (
    'Next Prime Group',
    'Software',
    165626.58,
    3073.9500414805298
  )
]","SELECT ""Customer Name"", ""Product Category"", SUM(""Total Revenue"") as revenue, SUM(""Total Revenue"") * 100.0 / SUM(""Total Revenue"") OVER (PARTITION BY ""Customer Name"") as revenue_percentage FROM sales_data WHERE Region = 'North America' AND strftime('%Y', ""Order Date"") = '2023' GROUP BY ""Customer Name"", ""Product Category"" ORDER BY revenue DESC LIMIT 5;","[('Delta Elite Systems', 'Software', 264491.81, 3285.1962856880245), ('Global Prime Inc.', 'Electronics', 172665.87, 3393.1100551808704), ('Global Beta Corp.', 'Software', 169027.36000000002, 1658.911871077284), ('Prime Delta Solutions', 'Electronics', 166806.53999999998, 1816.318788471401), ('Next Prime Group', 'Software', 165626.58, 3073.9500414805298)]",False,True
